<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
{#    <style type="text/css" >a:active{background-color:red; }</style>#}
    <link rel="stylesheet" href="{{ asset('theme/plugins/fontawesome-free/css/all.min.css') }}">
    <link rel="stylesheet" href="https://code.ionicframework.com/ionicons/2.0.1/css/ionicons.min.css">
    <link rel="stylesheet" href="{{ asset('theme/plugins/tempusdominus-bootstrap-4/css/tempusdominus-bootstrap-4.min.css')}}">
    <link rel="stylesheet" href="{{ asset('theme/plugins/icheck-bootstrap/icheck-bootstrap.min.css')}}">
    <link rel="stylesheet" href="{{ asset('theme/plugins/jqvmap/jqvmap.min.css')}}">
    <link rel="stylesheet" href="{{ asset('theme/dist/css/adminlte.min.css')}}">
    <link rel="stylesheet" href="{{ asset('theme/dist/css/adminlte.css')}}">
    <link rel="stylesheet" href="{{ asset('theme/plugins/overlayScrollbars/css/OverlayScrollbars.min.css')}}">
    <link rel="stylesheet" href="{{ asset('theme/plugins/daterangepicker/daterangepicker.css')}}">
    <link rel="stylesheet" href="{{ asset('theme/plugins/summernote/summernote-bs4.css')}}">
    <link href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,400i,700" rel="stylesheet">

    <title>{% block title %}Admin{% endblock %}</title>
    {% block stylesheets %}{% endblock %}

</head>
<body class="hold-transition sidebar-mini layout-fixed">
<div class="wrapper">

    <nav class="main-header navbar navbar-expand navbar-white navbar-light">
        <ul class="navbar-nav">
            <li class="nav-item">
                <a class="nav-link" data-widget="pushmenu" href="#" role="button"><i class="fas fa-bars"></i></a>
            </li>
        </ul>

        <ul class="navbar-nav ml-auto">
            {% if is_granted('IS_AUTHENTICATED_FULLY') %}
                <li class="nav-item dropdown">
                    <a class="nav-link" data-toggle="dropdown" href="#">
                        <i class="fas fas fa-user"></i>  {{ app.user.username }}
                    </a>
                    <div class="dropdown-menu dropdown-menu-lg dropdown-menu-right">
                        <div class="dropdown-divider"></div>
                        </a>
                        <div class="dropdown-divider"></div>
                        <a href="{{ path('app_logout') }}" class="dropdown-item">
                            Se Déconnecter
                        </a>
                    </div>
                </li>
            {% endif %}
        </ul>
        </nav>
    <aside class="main-sidebar sidebar-light-primary elevation-4">

        <div class="user-panel mt-3 pb-3 mb-3 d-flex">
            <div style="margin-left: auto; margin-right: auto;" >
                <img src="{{ asset('theme/dist/img/logo_2x.png')}}" style="width: 100%;" alt="Astral">
            </div>
        </div>
        <nav class="mt-2">
            <ul class="nav nav-pills nav-sidebar flex-column" data-widget="treeview" role="menu" data-accordion="false">
                <li class="nav-item">
                    <a href="{{ path('admin') }}" class="nav-link" id="dashboard">
                        <i class="nav-icon fas fa-tachometer-alt"></i>
                        <p>
                            Dashboard
                            <i class="right fas fa-angle-left"></i>
                        </p>
                    </a>

                </li>
                <li class="nav-item" id="az">
                    <a href="{{ path('user_list') }}" class="nav-link" id="users" >
                        <i class="nav-icon fas fa-user-plus"></i>
                        <p>
                            Utilisateurs
                            <i class="fas fa-angle-left right"></i>
                        </p>
                    </a>
                </li>
                <li class="nav-item">
                    <a href="{{ path('station_list') }}" class="nav-link" id="stations">
                        <i class="nav-icon fas fa-store"></i>
                        <p>
                            Régions
                            <i class="fas fa-angle-left right"></i>
                        </p>
                    </a>
                </li>
                <li class="nav-item">
                    <a href="{{ path('panel_list') }}" class="nav-link" id="panels">
                        <i class="nav-icon fas fa-gift"></i>
                        <p>
                            Cadeaux
                            <i class="fas fa-angle-left right"></i>
                        </p>
                    </a>
                </li>

                <li class="nav-item">
                    <a href="{{ path('operation_list') }}" class="nav-link" id="operations">
                        <i class="nav-icon fas fa-clipboard-list"></i>
                        <p>
                            Historique
                            <i class="fas fa-angle-left right"></i>
                        </p>
                    </a>
                </li>
            </ul>
        </nav>
    </aside>
</div>
<div class="content-wrapper">
    {% block body %}{% endblock %}
    {% block javascripts %}{% endblock %}

</div>
</body>


<script src="{{ asset('theme/plugins/jquery/jquery.min.js')}}"></script>
<script src="{{ asset('theme/plugins/jquery-ui/jquery-ui.min.js')}}"></script>
<script>$.widget.bridge('uibutton', $.ui.button)</script>
<script src="{{ asset('theme/plugins/bootstrap/js/bootstrap.bundle.min.js')}}"></script>
<script src="{{ asset('theme/plugins/chart.js/Chart.min.js')}}"></script>
<script src="{{ asset('theme/plugins/sparklines/sparkline.js')}}"></script>
<script src="{{ asset('theme/plugins/jqvmap/jquery.vmap.min.js')}}"></script>
<script src="{{ asset('theme/plugins/jqvmap/maps/jquery.vmap.usa.js')}}"></script>
<script src="{{ asset('theme/plugins/jquery-knob/jquery.knob.min.js')}}"></script>
<script src="{{ asset('theme/plugins/moment/moment.min.js')}}"></script>
<script src="{{ asset('theme/plugins/daterangepicker/daterangepicker.js')}}"></script>
<script src="{{ asset('theme/plugins/tempusdominus-bootstrap-4/js/tempusdominus-bootstrap-4.min.js')}}"></script>
<script src="{{ asset('theme/plugins/summernote/summernote-bs4.min.js')}}"></script>
<script src="{{ asset('theme/plugins/overlayScrollbars/js/jquery.overlayScrollbars.min.js')}}"></script>
<script src="{{ asset('theme/dist/js/adminlte.js')}}"></script>
<script src="{{ asset('theme/dist/js/pages/dashboard.js')}}"></script>
<script src="{{ asset('theme/dist/js/demo.js')}}"></script>
<script src="{{ asset('theme/plugins/flot/jquery.flot.js')}}"></script>
<script src="{{ asset('theme/plugins/flot-old/jquery.flot.resize.min.js')}}"></script>
<script src="{{ asset('theme/plugins/flot-old/jquery.flot.pie.min.js')}}"></script>

<script>


    $(function () {

        function getMonthFromString(mon){
            return new Date(Date.parse(mon +" 1, 2020")).getMonth()+1
        }
        $(document).ready(function () {
            $.get("{{path("operation_list_months")}}").done(function (res) {
                let array = []

                res.forEach(function (o,i) {
                    var row = [];
                    row[0] = getMonthFromString(o.month), row[1] = parseFloat(o.ops)
                    array.push(row)

                    var bar_data = {
                        data : array,
                        bars: { show: true }
                    }
                    $.plot('#bar-chart', [bar_data], {
                        grid  : {
                            borderWidth: 1,
                            borderColor: '#f3f3f3',
                            tickColor  : '#f3f3f3'
                        },
                        series: {
                            bars: {
                                show: true, barWidth: 0.5, align: 'center',
                            },
                        },
                        colors: ['#3c8dbc'],
                        xaxis : {
                            ticks: [[1,'Janvier'], [2,'Février'], [3,'Mars'], [4,'Avril'], [5,'Mai'], [6,'Juin'],[7,'Juillet'],[8,'Août'],[9,'Septembre'],[10,'Octobre'],[11,'Novembre'],[12, 'Decembre']]
                        }
                    });
                })
            })
        })
    })

</script>
<script>
    $(function () {

        $(document).ready(function () {
            $.get("{{path("operation_list_gouvernorat")}}").done(function (res) {
                let labels = []
                let datasets = []
                res.forEach(function (o, i) {
                    var lab = [];
                    var data = []
                    lab = o.gouvernorat
                    data= parseInt(o.nbrOperations)
                    labels.push(lab)
                    datasets.push(data)
                })
                var donutChartCanvas = $('#donutChart').get(0).getContext('2d')
                var donutData = {
                    labels: labels,
                    datasets: [
                        {
                            data: datasets,
                            backgroundColor: [
                                'rgba(255, 99, 132, 0.6)',
                                'rgba(54, 162, 235, 0.6)',
                                'rgba(255, 206, 86, 0.6)',
                                'rgba(75, 192, 192, 0.6)',
                                'rgba(153, 102, 255, 0.6)',
                                'rgba(255, 159, 64, 0.6)',
                                'rgba(255, 99, 132, 0.6)'
                            ],
                            borderWidth: 1,
                            borderColor: '#777',

                        }
                    ]
                }
                var donutOptions = {
                    maintainAspectRatio: false,
                    responsive: true,
                    legend: {

                        display: true,
                        position: 'right',
                        labels: {
                            fontSize:16,
                            fontColor: '#000'
                        }},
                    layout: {
                        padding: {
                            left: 200,
                            right: 100,
                            bottom: 0,
                            top: 0
                        },
                    },
                    title: {
                        display: false,
                        text: 'Nombre d\'opérations par Gouvernorat ',
                        fontSize: 25
                    },
                }

                var donutChart = new Chart(donutChartCanvas, {
                    type: 'doughnut',
                    data: donutData,
                    options: donutOptions

                })
            })
        })
    })
</script>
</html>
